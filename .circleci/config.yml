version: 2.1



jobs:
  build:
    environment:
      ANDROID_HOME: "/usr/local/opt/android-sdk"
      ANDROID_SDK_HOME: "/usr/local/opt/android-sdk"
      ANDROID_SDK_ROOT: "/usr/local/opt/android-sdk"
    macos:
      xcode: 14.2.0
    steps:
      - checkout
      - run:
          command: | 
            brew tap caskroom/cask
            brew tap caskroom/versions
            brew cask install android-sdk
            which android
      - run:
          name: Build and execute tests
          command: ./gradlew test
      - run:
          name: Upload code coverage
          when: on_success
          command: bash <(curl -s https://codecov.io/bash)

workflows:
  gradle_test:
    jobs:
      - build
